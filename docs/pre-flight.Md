Parfait ğŸ‘‡
Je vais te donner la V0 du pre-flight checklist Acheteur Vegito.
On reste dans le mÃªme niveau de granularitÃ© que ce quâ€™on a fait sur le parcours Vendeur.

â¸»

ğŸ§¾ Pre-Flight Checklist - Parcours Acheteur Vegito

1ï¸âƒ£ PrÃ©requis globaux
â€¢ API backend dâ€™inscription utilisateur fonctionnelle (Firebase + Anonymous Login : âœ…)
â€¢ Authentification sÃ©curisÃ©e sur mobile Flutter dÃ©jÃ  en place.
â€¢ Firestore / Backend API exposant les lÃ©gumes publiÃ©s en mode â€œvisibleâ€ (dÃ©jÃ  existant cÃ´tÃ© vendeur).
â€¢ Firebase Storage opÃ©rationnel pour les images produits.
â€¢ Billing Stripe et/ou wallet STX connectÃ© en mode test/dev.

â¸»

2ï¸âƒ£ Parcours utilisateur Acheteur

2.1. Ã‰cran dâ€™accueil / Home page
â€¢ Chargement des produits en vente via API backend (liste paginÃ©e).
â€¢ Affichage des vignettes lÃ©gumes (image + nom + prix + stock).
â€¢ Filtrage possible (par catÃ©gorie / par prix / par localisation future si besoin).

2.2. Ã‰cran dÃ©tail produit
â€¢ Chargement des donnÃ©es du lÃ©gume : nom, description, image(s), prix, mode de vente (kg/unitÃ©).
â€¢ VÃ©rification des liens images corrects (publicUrl backend transmis).
â€¢ Gestion des images servies via CDN Firebase.

2.3. Ajout panier / checkout
â€¢ Ajout du lÃ©gume au panier avec quantitÃ©.
â€¢ VÃ©rification des stocks en temps rÃ©el avant validation.
â€¢ Visualisation du panier.

2.4. Paiement
â€¢ IntÃ©gration Stripe test âœ… (mode test)
â€¢ Option Wallet STX (survolÃ©e dans un premier temps)
â€¢ Calcul des frais Ã©ventuels (ex : frais Vegito minimal).

2.5. Confirmation de commande
â€¢ GÃ©nÃ©ration dâ€™un numÃ©ro de commande unique.
â€¢ Stock mis Ã  jour.
â€¢ Email de confirmation (via Firebase Functions ?)
â€¢ Historique commandes accessible pour lâ€™acheteur.

â¸»

3ï¸âƒ£ Tests & monitoring
â€¢ Ã‰criture des tests end-to-end Appium pour ce flux.
â€¢ Logs backend sur GCP pour tracing des commandes.
â€¢ Ajout monitoring basique (Stackdriver / Logging GCP).

â¸»

4ï¸âƒ£ Go / No Go
â€¢ Si ce bloc fonctionne de bout-en-bout â†’ tu peux ouvrir une premiÃ¨re beta privÃ©e avec quelques testeurs.

â¸»

ğŸ‘‰ REMARQUE IMPORTANTE TECHNIQUE

Ton backend est dÃ©jÃ  trÃ¨s bien conÃ§u pour supporter cette extension.
Câ€™est surtout du wiring propre Flutter / backend et de la validation mÃ©tier.

â¸»

Prochaine Ã©tape possible :

Je peux te gÃ©nÃ©rer un plan de tÃ¢ches codables (tickets)
pour que tu puisses avancer dessus de maniÃ¨re sÃ©quencÃ©e en conservant lâ€™esprit Vegito-engineering-style ğŸ‘¨â€ğŸ’».

â¸»

Veux-tu que je tâ€™enchaÃ®ne sur le dÃ©coupage codable des tickets acheteur V1 ?
(Si tu me dis oui => on passe en mode mode CTO plan opÃ©rationnel ğŸ§±)

Excellent. LÃ  on va rentrer dans la phase que tu aimes : le dÃ©coupÃ© chirurgical prÃªt-Ã -coder.

â¸»

ğŸ¯ Plan de tÃ¢ches codables â€” Parcours Acheteur Vegito V1

â¸»

ğŸŸ© Bloc 1 â€” PrÃ©parer les modÃ¨les partagÃ©s

ğŸ‘‰ Backend et Flutter partagent quasiment la mÃªme structure de donnÃ©e Vegetable.

Ticket 1.1 â€” Ajouter la sÃ©rialisation client des Vegetable cÃ´tÃ© Flutter
â€¢ VÃ©rifier que les modÃ¨les Vegetable et VegetableImage existants intÃ¨grent les bons champs :
â€¢ id, name, description, price, quantity, pricePerUnit, images (publicUrl complet fourni par backend).
â€¢ Ajouter dans Flutter le parseur HTTP des lÃ©gumes reÃ§us depuis lâ€™API (mapper propre).

Ticket 1.2 â€” Adapter le provider Flutter pour rÃ©cupÃ©rer la liste
â€¢ Ajouter VegetableMarketProvider (nouveau provider buyer).
â€¢ Fonction fetchMarketVegetables() â†’ appel REST existant vers le backend (avec firebaseIdToken en auth).
â€¢ Tests unitaires sur la dÃ©sÃ©rialisation.

â¸»

ğŸŸ© Bloc 2 â€” Ã‰cran Home (liste des lÃ©gumes disponibles)

Ticket 2.1 â€” CrÃ©er lâ€™Ã©cran MarketHomeScreen
â€¢ Liste scrollable verticale.
â€¢ Chaque carte : image principale (thumbnail), nom, prix, stock restant.
â€¢ Appel au provider VegetableMarketProvider.

Ticket 2.2 â€” Gestion des erreurs et du loading
â€¢ Afficher un spinner de chargement initial.
â€¢ GÃ©rer les cas dâ€™erreurs rÃ©seau avec un placeholder.

â¸»

ğŸŸ© Bloc 3 â€” Ã‰cran dÃ©tail lÃ©gume

Ticket 3.1 â€” CrÃ©er lâ€™Ã©cran VegetableDetailScreen
â€¢ Affichage de toutes les images.
â€¢ Description complÃ¨te.
â€¢ Prix.
â€¢ Stock disponible.
â€¢ Champ quantitÃ© Ã  commander.

Ticket 3.2 â€” Calcul dynamique du total selon la quantitÃ© choisie
â€¢ (si vente au poids : multiplication simple ; sinon nombre dâ€™unitÃ©s.)

â¸»

ğŸŸ© Bloc 4 â€” Panier / Checkout simplifiÃ© V1

Ticket 4.1 â€” CrÃ©er un CartProvider Flutter
â€¢ Support de base pour lâ€™ajout/suppression dâ€™items.
â€¢ Liste des articles courants.
â€¢ Calcul du sous-total.

Ticket 4.2 â€” Ã‰cran CartScreen
â€¢ Liste dâ€™articles.
â€¢ QuantitÃ©s modifiables.
â€¢ Bouton â€œPayerâ€.

â¸»

ğŸŸ© Bloc 5 â€” Paiement

Ticket 5.1 â€” IntÃ©gration Stripe Flutter (Test Mode)
â€¢ Setup API keys Firebase Functions ou Backend GCP (tu as les deux possibilitÃ©s).
â€¢ Checkout via Stripe SDK Flutter.
â€¢ Retour de confirmation.

â¸»

ğŸŸ© Bloc 6 â€” Confirmation de commande

Ticket 6.1 â€” Appeler le backend pour valider la commande
â€¢ Appel REST avec contenu du panier.
â€¢ Backend stocke la commande + ajuste stock.

Ticket 6.2 â€” Ã‰cran de confirmation
â€¢ NumÃ©ro de commande.
â€¢ Message de validation.

â¸»

ğŸŸ© Bloc 7 â€” Historique commandes

Ticket 7.1 â€” CrÃ©er lâ€™Ã©cran OrderHistoryScreen
â€¢ Liste des commandes passÃ©es.
â€¢ Backend fournit lâ€™historique (Ã  coder via API REST dÃ©diÃ©e).

â¸»

âœ… Fin de V1 codable propre.

â¸»

ğŸ’¡ OPTION PRO :

Si tu veux, on peut aussi construire un Makefile subproject buyer pour tes tests Flutter + Appium spÃ©cifique buyer, comme on lâ€™a fait pour le seller.
Ã‡a tâ€™Ã©vitera la dette technique dÃ¨s maintenant.

â¸»

Veux-tu que je gÃ©nÃ¨re directement :

âœ… le squelette initial des providers / screens Flutter
âœ… le Makefile test buyer

â€¦ pour dÃ©marrer clean ?
ğŸ‘‰ Dis-moi GO CODING PLAN et on dÃ©gaine.
